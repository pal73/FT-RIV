#include "ztt.h"
#include "main.h"

char portForZTTBatteryIsInitiated=0;
char zTTBatteryHndlPhase;
//char zTTBatteryInBuff[300];
char zTTRequestPhase;
short zTTSilentCnt;
char zTTButteryCnter=0;

void ztt_bat_hndl(void)
{

if(portForZTTBatteryIsInitiated==0)
	{
	UARTInit(0, 9600);	/* baud rate setting */
	portForZTTBatteryIsInitiated=1;
	}

zTTBatteryHndlPhase++;

if(zTTBatteryHndlPhase==5)	//7E 32 36 30 30 34 36 34 32 45 30 30 32 30 31 46 44 33 30 0D
	{
	if(zTTButteryCnter==0)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x32,0x45,0x30,0x30,0x32,0x30,0x31,0x46,0x44,0x33,0x30,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}
	else if(zTTButteryCnter==1)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x32,0x45,0x30,0x30,0x32,0x30,0x32,0x46,0x44,0x32,0x46,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}
	else if(zTTButteryCnter==2)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x32,0x45,0x30,0x30,0x32,0x30,0x33,0x46,0x44,0x32,0x45,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}

	zTTRequestPhase=0;

	if(zTTSilentCnt<10) zTTSilentCnt++;
	
	}
else if(zTTBatteryHndlPhase==10)
	{
	if(zTTButteryCnter==0)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x34,0x45,0x30,0x30,0x32,0x30,0x31,0x46,0x44,0x32,0x45,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}
	else if(zTTButteryCnter==1)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x34,0x45,0x30,0x30,0x32,0x30,0x32,0x46,0x44,0x32,0x44,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}
	else if(zTTButteryCnter==2)
		{
		char zTTButteryOutBuff[]={0x7e,0x32,0x36,0x30,0x30,0x34,0x36,0x34,0x34,0x45,0x30,0x30,0x32,0x30,0x33,0x46,0x44,0x32,0x45,0x0d};
		uart_out_buff0(zTTButteryOutBuff,20);
		}

	zTTRequestPhase=0;

	zTTBatteryHndlPhase=0;
	
	zTTButteryCnter++;
	if(zTTButteryCnter>=NUMBAT_TELECORE)zTTButteryCnter=0;


/*	if(zTTSilentCnt<10) zTTSilentCnt++;	*/

	}

}

